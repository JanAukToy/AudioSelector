//******************************************************************************
// Created by JanAukToy
// [Github] https://github.com/JanAukToy
//******************************************************************************
unit cls_SoundDevices;

interface

uses
  System.SysUtils, System.Classes, System.Win.ComObj, System.SyncObjs,
  Winapi.Windows, Winapi.ActiveX,

  myMMDeviceAPI;

type
  TSoundDevices = class
  private
    f_Initialized: Boolean;

    f_DeviceEnumerator: IMMDeviceEnumerator;
    f_DeviceCollection: IMMDeviceCollection;
  public
    constructor Create();
    destructor Destroy; override;

    property Initialized: Boolean read f_Initialized;
  end;

implementation

uses
  System.StrUtils;

{ TAudioDevices }

//******************************************************************************
// コンストラクター
constructor TSoundDevices.Create;
begin
  f_Initialized := False;

  if CoCreateInstance(CLSID_IMMDeviceEnumerator, nil, CLSCTX_INPROC_SERVER,
    IID_IMMDeviceEnumerator, f_DeviceEnumerator) = S_OK then
  begin
    f_Initialized := f_DeviceEnumerator.EnumAudioEndpoints(eRender, DEVICE_STATE_ACTIVE, f_DeviceCollection) = S_OK;
  end;
end;

//******************************************************************************
// デストラクター
destructor TSoundDevices.Destroy;
begin
  ;

  inherited;
end;
end.
