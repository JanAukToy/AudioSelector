unit cls_AudioDevice;

interface

uses
  System.SysUtils,
  System.Classes,
  System.Win.ComObj,
  System.SyncObjs,
  Winapi.Windows,
  Winapi.ActiveX,
  JAT.MMDeviceAPI, JAT.EndpointVolume, JAT.AudioClient;

type
  TAudioDevice = class
  private
    f_AudioEndpointVolume: IAudioEndpointVolume;
    f_AudioClient: IAudioClient;
  public
    constructor Create(const a_Device: IMMDevice);
    destructor Destroy; override;
  end;

implementation

{ TAudioDevice }

// *****************************************************************************
// Constructor
constructor TAudioDevice.Create(const a_Device: IMMDevice);
var
  l_PointAudioEndpointVolume: Pointer;
  l_PointAudioClient: Pointer;
begin
  // Get Audio Endpoint Volume
  if a_Device.Activate(IID_IAudioEndpointVolume, CLSCTX_INPROC_SERVER, nil,
    l_PointAudioEndpointVolume) = S_OK then
  begin
    f_AudioEndpointVolume := IAudioEndpointVolume(l_PointAudioEndpointVolume)
      as IAudioEndpointVolume;
  end;
end;

// *****************************************************************************
// Destructor
destructor TAudioDevice.Destroy;
begin

  inherited;
end;

end.
