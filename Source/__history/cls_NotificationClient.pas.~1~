unit cls_NotificationClient;

interface

uses
  System.SysUtils,
  System.Classes,
  System.Win.ComObj,
  System.SyncObjs,
  System.Generics.Collections,
  Winapi.Windows,
  Winapi.ActiveX,

  JAT.MMDeviceAPI, JAT.EndpointVolume, JAT.AudioClient, cls_AudioDevice;

type
  TNotificationClient = class(TInterfacedObject, IMMNotificationClient)
  private
    f_Count: Integer;
  public
    function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
    function _AddRef: Integer; stdcall;
    function _Release: Integer; stdcall;

    function OnDeviceStateChanged(pwstrDeviceId: PWideChar; dwNewState: DWORD)
      : HResult; stdcall;
    function OnDeviceAdded(pwstrDeviceId: PWideChar): HResult; stdcall;
    function OnDeviceRemoved(pwstrDeviceId: PWideChar): HResult; stdcall;
    function OnDefaultDeviceChanged(flow: EDataFlow; role: ERole;
      pwstrDefaultDeviceId: PWideChar): HResult; stdcall;
    function OnPropertyValueChanged(pwstrDeviceId: PWideChar;
      const key: PROPERTYKEY): HResult; stdcall;
  end;

implementation

{ TNotificationClient }

function TNotificationClient.QueryInterface(const IID: TGUID; out Obj): HResult;
begin
  Result := S_OK;
end;

function TNotificationClient._AddRef: Integer;
begin
  Inc(FRefCount);
  Result := FRefCount;
end;

function TNotificationClient._Release: Integer;
begin
  Dec(FRefCount);
  Result := f_Count;
end;

function TNotificationClient.OnDefaultDeviceChanged(flow: EDataFlow;
  role: ERole; pwstrDefaultDeviceId: PWideChar): HResult;
begin

end;

function TNotificationClient.OnDeviceAdded(pwstrDeviceId: PWideChar): HResult;
begin

end;

function TNotificationClient.OnDeviceRemoved(pwstrDeviceId: PWideChar): HResult;
begin

end;

function TNotificationClient.OnDeviceStateChanged(pwstrDeviceId: PWideChar;
  dwNewState: DWORD): HResult;
begin

end;

function TNotificationClient.OnPropertyValueChanged(pwstrDeviceId: PWideChar;
  const key: PROPERTYKEY): HResult;
begin

end;

end.
